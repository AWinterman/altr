{"version":3,"file":"bundle.js","sources":["/Users/michaelhayes/work/altr/node_modules/browserify/node_modules/browser-pack/_prelude.js","/Users/michaelhayes/work/altr/lib/browser.js","/Users/michaelhayes/work/altr/lib/index.js","/Users/michaelhayes/work/altr/lib/tags/placeholder.js","/Users/michaelhayes/work/altr/lib/tags/children.js","/Users/michaelhayes/work/altr/lib/tags/include.js","/Users/michaelhayes/work/altr/lib/tags/text.js","/Users/michaelhayes/work/altr/lib/tags/html.js","/Users/michaelhayes/work/altr/lib/tags/with.js","/Users/michaelhayes/work/altr/lib/tags/for.js","/Users/michaelhayes/work/altr/lib/tags/if.js","/Users/michaelhayes/work/altr/lib/altr.js","/Users/michaelhayes/work/altr/lib/template_string.js","/Users/michaelhayes/work/altr/lib/element_node.js","/Users/michaelhayes/work/altr/lib/text_node.js","/Users/michaelhayes/work/altr/lib/to_string.js","/Users/michaelhayes/work/altr/lib/get_element.js","/Users/michaelhayes/work/altr/lib/replace.js","/Users/michaelhayes/work/altr/lib/render.js","/Users/michaelhayes/work/altr/lib/insert.js","/Users/michaelhayes/work/altr/lib/remove.js","/Users/michaelhayes/work/altr/lib/raf.js","/Users/michaelhayes/work/altr/lib/set_children.js","/Users/michaelhayes/work/altr/node_modules/browserify/node_modules/events/events.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/index.js","/Users/michaelhayes/work/altr/node_modules/batch-queue/index.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/lookup.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/create.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/operators.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/filter.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/parens.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/types.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/arrow.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/lib/split.js","/Users/michaelhayes/work/altr/node_modules/altr-accessors/node_modules/just-debounce/index.js"],"names":["module","exports","global","altr","require","placeholder","children_tag","include_tag","text_tag","html_tag","with_tag","for_tag","if_tag","addTag","el","accessor","update","val","nodeName","replace","parentNode","_altr_placeholder","this","batch","add","createAccessor","children","nodes","Array","isArray","set_children","call","filter","is_node","bind","nodeType","include","name","innerHTML","includes","updateNodes","childNodes","text","textContent","html","getAttribute","forEach","getElementsByTagName","run","script","fixed","document","createElement","parent","attrs","attributes","i","l","length","setAttribute","value","insertBefore","removeChild","for_handler","root","args","update_children","data","item_data","Object","create","prop","items","new_items","index","new_children","dom_nodes","find_index","unique","splice","make_children","concat","slice","run_updates","d","indexOf","temp","createElementNS","namespaceURI","template","prototype","run_dom_updates","parts","match","for_regexp","Error","split","key","toggle","show","hide","createComment","hidden","sync","doc","window","dom_module","EE","filters","accessors","runBatch","raf","Buffer","toString","createDocumentFragment","firstChild","appendChild","_update","rootNodes","state","update_nodes","hooks","self","initNodes","init_nodes","flatten","lhs","rhs","map","init_node","Boolean","reduce","node_handlers","root_nodes","DOCUMENT_FRAGMENT_NODE","add_filter","add_tag","attr","tag","tags","tagList","push","constructor","append_to","node","get_el","create_accessor","description","change","fn","run_batch","emit","template_string","element_node","EventEmitter","text_node","render","insert","remove","addFilter","templateString","initNode","getElement","into","set_part","idx","join","hook","TAG","next","remaining","create_element_node","altr_tags","removeAttribute","attr_hook","init_text_node","clone","cloneNode","COMMENT_NODE","TEXT_NODE","outerHTML","old","replaceChild","instance","before","inserted","nextSibling","requestAnimationFrame","callback","timeout","setTimeout","webkitRequestAnimationFrame","mozRequestAnimationFrame","prev","get","_events","_maxListeners","undefined","isFunction","arg","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","n","isNaN","TypeError","type","er","handler","len","listeners","error","arguments","apply","addListener","listener","m","newListener","warned","console","trace","on","once","g","removeListener","fired","list","position","removeAllListeners","ret","listenerCount","emitter","delay","str","all","write","out","part","create_part","debounce","add_operators","create_accesor","add_lookup","add_parens","add_types","add_arrow","types","Batch","ready","jobs","queud","queue","queued","create_lookup","path","lookup","done","search","obj","ctx","context","finish","build_part","create_ternary","binary","unary","regex","RegExp","create_binary","create_unary","ok","not","ternary_regexp","condition","rest","on_data","check_lhs","check_rhs","is_rhs","changed","Function","create_filter","filter_regexp","create_parens","parens_regexp","body","count","content","Math","random","create_string_accessor","create_number_accessor","string_regexp","number_regexp","create_arrow","right","left","opens","closes","split_point","all_closes","all_opens","sum","counts","j","at_start","guarantee","clear","clearTimeout"],"mappings":"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","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","module.exports = global.altr = require('./index')\n","var placeholder = require('./tags/placeholder')\n  , children_tag = require('./tags/children')\n  , include_tag = require('./tags/include')\n  , text_tag = require('./tags/text')\n  , html_tag = require('./tags/html')\n  , with_tag = require('./tags/with')\n  , for_tag = require('./tags/for')\n  , if_tag = require('./tags/if')\n  , altr = require('./altr')\n\nmodule.exports = altr\n\naltr.addTag('altr-placeholder', placeholder)\naltr.addTag('altr-children', children_tag)\naltr.addTag('altr-include', include_tag)\naltr.addTag('altr-text', text_tag)\naltr.addTag('altr-html', html_tag)\naltr.addTag('altr-with', with_tag)\naltr.addTag('altr-for', for_tag)\naltr.addTag('altr-if', if_tag)\n","module.exports = placeholder\n\nfunction placeholder(el, accessor) {\n  var altr = this\n\n  return this.batch.add(this.createAccessor(accessor, update))\n\n  function update(val) {\n    if(!val.nodeName) {\n      return\n    }\n\n    altr.replace(el.parentNode, val, el)\n    el._altr_placeholder = val\n    el = val\n  }\n}\n","var set_children = require('../set_children')\n\nmodule.exports = children\n\nfunction children(el, accessor) {\n  return this.batch.add(this.createAccessor(accessor, update.bind(this)))\n\n  function update(val) {\n    var nodes = Array.isArray(val) ? val : [val]\n\n    set_children.call(this, el, nodes.filter(is_node))\n  }\n}\n\nfunction is_node(el) {\n  return el && el.nodeType\n}\n","module.exports = include\n\nfunction include(el, name) {\n  el.innerHTML = this.includes[name]\n\n  return this.updateNodes(el.childNodes)\n}\n","module.exports = text\n\nfunction text(el, accessor) {\n  return this.batch.add(this.createAccessor(accessor, update))\n\n  function update(val) {\n    el.textContent = typeof val === 'undefined' ? '' : val\n  }\n}\n","module.exports = html\n\nfunction html(el, accessor) {\n  return this.batch.add(this.createAccessor(accessor, update))\n\n  function update(val) {\n    el.innerHTML = typeof val === 'undefined' ? '' : val\n\n    if(el.getAttribute('altr-run-scripts')) {\n      [].forEach.call(el.getElementsByTagName('script'), run)\n    }\n  }\n}\n\nfunction run(script) {\n  var fixed = document.createElement('script')\n    , parent = script.parentNode\n    , attrs = script.attributes\n    , src\n\n  for(var i = 0, l = attrs.length; i < l; ++i) {\n    fixed.setAttribute(attrs[i].name, attrs[i].value)\n  }\n\n  fixed.textContent = script.textContent\n  parent.insertBefore(fixed, script)\n  parent.removeChild(script)\n}\n","module.exports = with_tag\n\nfunction with_tag(el, accessor) {\n  return this.createAccessor(accessor, this.updateNodes(el.childNodes))\n}\n","var set_children = require('../set_children')\n  , for_regexp = /^(.*?)\\s+in\\s+(.*$)/\n\nmodule.exports = for_handler\n\nfunction for_handler(root, args) {\n  var parts = args.match(for_regexp)\n    , template = root.innerHTML\n    , dom_nodes = []\n    , children = []\n    , altr = this\n    , items = []\n\n  if(!parts) {\n    throw new Error('invalid for tag: ' + args)\n  }\n\n  root.innerHTML = ''\n\n  var unique = parts[1].split(':')[1]\n    , prop = parts[1].split(':')[0]\n    , key = parts[2]\n\n  var run_updates = this.batch.add(run_dom_updates)\n\n  return altr.createAccessor(key, update)\n\n  function update_children(data) {\n    var item_data\n\n    for(var i = 0, l = children.length; i < l; ++i) {\n      item_data = Object.create(data)\n      item_data[prop] = items[i]\n      item_data['$index'] = i\n\n      children[i].update && children[i].update(item_data)\n    }\n  }\n\n  function update(new_items, data) {\n    if(!Array.isArray(new_items)) {\n      new_items = []\n    }\n\n    var new_children = new Array(new_items.length)\n      , index\n\n    dom_nodes = []\n\n    for(var i = 0, l = new_items.length; i < l; ++i) {\n      index = find_index(items, new_items[i], unique)\n\n      if(index !== -1) {\n        new_children[i] = (children.splice(index, 1)[0])\n        items.splice(index, 1)\n      } else {\n        new_children[i] = make_children()\n      }\n\n      dom_nodes = dom_nodes.concat(new_children[i].dom_nodes)\n    }\n\n    children = new_children.slice()\n    items = new_items.slice()\n    run_updates.call(altr)\n    update_children(data)\n  }\n\n  function find_index(items, d, unique) {\n    if(!unique) {\n      return items.indexOf(d)\n    }\n\n    for(var i = 0, l = items.length; i < l; ++i) {\n      if(items[i][unique] === d[unique]) {\n        return i\n      }\n    }\n\n    return -1\n  }\n\n  function make_children() {\n    var temp = altr.document.createElementNS(root.namespaceURI, 'div')\n      , dom_nodes\n      , update\n\n    temp.innerHTML = template\n\n    dom_nodes = Array.prototype.slice.call(temp.childNodes)\n    update = altr.updateNodes(dom_nodes)\n\n    return {\n        dom_nodes: dom_nodes\n      , update: update\n    }\n  }\n\n  function run_dom_updates() {\n    set_children.call(this, root, dom_nodes)\n  }\n}\n","module.exports = if_tag\n\nfunction if_tag(el, accessor) {\n  var placeholder = this.document.createComment('altr-if-placeholder')\n    , update_children = this.updateNodes(el.childNodes)\n    , hidden = null\n    , altr = this\n\n  var hide = this.batch.add(function() {\n    var parent = el.parentNode\n\n    if(!hidden) {\n      altr.replace(el.parentNode, placeholder, el)\n      el._altr_placeholder = placeholder\n      hidden = true\n    }\n  })\n\n  var show = this.batch.add(function() {\n    if(hidden) {\n      altr.replace(placeholder.parentNode, el, placeholder)\n      delete el._altr_placeholder\n      hidden = false\n    }\n  })\n\n  return this.createAccessor(accessor, toggle)\n\n  function toggle(val, data) {\n    if(!val) {\n      return hide()\n    }\n\n    show()\n    update_children(data)\n  }\n}\n","var template_string = require('./template_string')\n  , element_node = require('./element_node')\n  , accessors = require('altr-accessors')\n  , EE = require('events').EventEmitter\n  , text_node = require('./text_node')\n  , toString = require('./to_string')\n  , get_el = require('./get_element')\n  , batch = require('batch-queue')\n  , replace = require('./replace')\n  , render = require('./render')\n  , insert = require('./insert')\n  , remove = require('./remove')\n  , raf = require('./raf')\n\nvar dom_module = 'micro-dom'\n\naltr.filters = {}\naltr.includes = {}\naltr.render = render\naltr.addTag = add_tag\naltr.include = include\naltr.addFilter = add_filter\n\nmodule.exports = altr\n\nfunction altr(root, data, sync, doc) {\n  if(!(this instanceof altr)) {\n    return new altr(root, data, sync, doc)\n  }\n\n  if(!global.window) {\n    doc = doc || require(dom_module).document\n  }\n\n  EE.call(this)\n  this.sync = typeof sync === 'undefined' ? false : sync\n  this.root = root\n  this.document = doc || global.document || require(dom_module)\n  this.filters = Object.create(altr.filters)\n  this.includes = Object.create(altr.includes)\n  this.accessors = accessors(this.filters, false)\n  this.batch = batch((function() {\n    this.sync ? this.runBatch() : raf(this.runBatch.bind(this))\n  }).bind(this))\n\n  if(global.Buffer && root instanceof global.Buffer) {\n    root = root.toString()\n  }\n\n  if(typeof root === 'string') {\n    var temp = this.document.createElement('div')\n\n    temp.innerHTML = root\n    this.root = this.document.createDocumentFragment()\n\n    while(temp.firstChild) {\n      this.root.appendChild(temp.firstChild)\n    }\n  }\n\n  this._update = this.updateNodes(this.rootNodes())\n\n  if(data) {\n    this.update(data, true)\n  }\n}\n\naltr.prototype = Object.create(EE.prototype)\naltr.prototype.constructor = altr\n\naltr.prototype.templateString = template_string\naltr.prototype.createAccessor = create_accessor\naltr.prototype.updateNodes = update_nodes\naltr.prototype.initNodes = init_nodes\naltr.prototype.rootNodes = root_nodes\naltr.prototype.addFilter = add_filter\naltr.prototype.runBatch = run_batch\naltr.prototype.initNode = init_node\naltr.prototype.toString = toString\naltr.prototype.getElement = get_el\naltr.prototype.include = include\naltr.prototype.replace = replace\naltr.prototype.into = append_to\naltr.prototype.update = update\naltr.prototype.insert = insert\naltr.prototype.remove = remove\naltr.prototype.tagList = []\naltr.prototype.tags = {}\n\nvar node_handlers = {}\n\nnode_handlers[1] = element_node\nnode_handlers[3] = text_node\n\nfunction update(data, sync) {\n  this.state = data\n  this._update(data)\n\n  if(sync) {\n    this.batch.run()\n  }\n}\n\nfunction update_nodes(nodes) {\n  var hooks = this.initNodes(nodes)\n    , self = this\n\n  return update\n\n  function update(data) {\n    for(var i = 0, l = hooks.length; i < l; ++i) {\n      hooks[i].call(self, data)\n    }\n  }\n}\n\nfunction init_nodes(nodes, list) {\n  var hooks = [].slice.call(nodes)\n    .map(init_node.bind(this))\n    .filter(Boolean)\n    .reduce(flatten, [])\n\n  return hooks\n\n  function flatten(lhs, rhs) {\n    return lhs.concat(rhs)\n  }\n}\n\nfunction init_node(el) {\n  return node_handlers[el.nodeType] ?\n    node_handlers[el.nodeType].call(this, el) :\n    el.childNodes && el.childNodes.length ?\n    this.initNodes(el.childNodes) :\n    null\n}\n\nfunction root_nodes() {\n  return this.root.nodeType === this.document.DOCUMENT_FRAGMENT_NODE ?\n    [].slice.call(this.root.childNodes) :\n    [this.root]\n}\n\nfunction add_filter(name, filter) {\n  altr.filters[name] = filter\n}\n\nfunction add_tag(attr, tag) {\n  altr.prototype.tags[attr] = tag\n  altr.prototype.tagList.push({\n      attr: attr\n    , constructor: tag\n  })\n}\n\nfunction append_to(node) {\n  var root_nodes = this.rootNodes()\n\n  for(var i = 0, l = root_nodes.length; i < l; ++i) {\n    node.appendChild(get_el(root_nodes[i]))\n  }\n}\n\nfunction include(name, template) {\n  return this.includes[name] = template\n}\n\nfunction create_accessor(description, change) {\n  return this.accessors.create(description, change, false)\n}\n\nfunction add_filter(name, fn) {\n  return this.filters[name] = fn\n}\n\nfunction run_batch() {\n  this.batch.run()\n  this.emit('update', this.state)\n}\n","var TAG = /{{\\s*(.*?)\\s*}}/\n\nmodule.exports = template_string\n\nfunction template_string(template, change) {\n  if(!template.match(TAG)) {\n    return\n  }\n\n  var remaining = template\n    , parts = []\n    , hooks = []\n    , timer\n    , index\n    , next\n\n  while(remaining && (next = remaining.match(TAG))) {\n    if(index = remaining.indexOf(next[0])) {\n      parts.push(remaining.slice(0, index))\n    }\n\n    parts.push('')\n    remaining = remaining.slice(index + next[0].length)\n    hooks.push(\n        this.createAccessor(next[1], set_part.bind(this, parts.length - 1))\n    )\n  }\n\n  parts.push(remaining)\n\n  return update\n\n  function set_part(idx, val) {\n    parts[idx] = val\n    change(parts.join(''))\n  }\n\n  function update(data) {\n    hooks.forEach(function(hook) {\n      hook(data)\n    })\n  }\n}\n","module.exports = create_element_node\n\nfunction create_element_node(el) {\n  var altr_tags = {}\n    , altr = this\n    , hooks = []\n    , attr\n\n  var attrs = Array.prototype.filter.call(el.attributes, function(attr) {\n    return altr.tags[attr.name] ?\n      (altr_tags[attr.name] = attr.value) && false :\n      true\n  })\n\n  attrs.forEach(function(attr) {\n    var value = attr.value\n      , name = attr.name\n\n    if(!name.indexOf('altr-attr-')) {\n      name = attr.name.slice('altr-attr-'.length)\n      el.removeAttribute(attr.name)\n    }\n\n    var attr_hook = altr.templateString(value, altr.batch.add(function(val) {\n      el.setAttribute(name, val)\n    }))\n\n    if(attr_hook) {\n      hooks.push(attr_hook)\n    }\n  })\n\n  for(var i = 0, l = altr.tagList.length; i < l; ++i) {\n    if(attr = altr_tags[altr.tagList[i].attr]) {\n      hooks.push(altr.tagList[i].constructor.call(altr, el, attr))\n\n      return hooks\n    }\n  }\n\n  return hooks.concat(altr.initNodes(el.childNodes))\n}\n","module.exports = init_text_node\n\nfunction init_text_node(el) {\n  var hook = this.templateString(el.textContent, this.batch.add(update))\n\n  return hook ? [hook] : null\n\n  function update(val) {\n    el.textContent = val\n  }\n}\n","module.exports = toString\n\nfunction toString() {\n  return this.rootNodes().map(function(node) {\n    switch(node.nodeType) {\n      case this.document.DOCUMENT_FRAGMENT_NODE:\n      case this.document.COMMENT_NODE: return clone.call(this, node)\n      case this.document.TEXT_NODE: return node.textContent\n      default: return node.outerHTML\n    }\n  }, this).join('')\n\n  function clone(node) {\n    var temp = this.document.createElement('div')\n\n    temp.appendChild(node.cloneNode())\n\n    return temp.innerHTML\n  }\n}\n","module.exports = get_el\n\nfunction get_el(el) {\n  while(el && el._altr_placeholder) {\n    el = el._altr_placeholder\n  }\n\n  return el\n}\n","module.exports = replace\n\nfunction replace(parent, el, old) {\n  parent.replaceChild(el, old)\n  this.emit('replace', el, old, parent)\n  this.emit('insert', el, parent)\n  this.emit('remove', old, parent)\n}\n","module.exports = render\n\nfunction render(template, state, el) {\n  if(this.includes[template]) {\n    template = this.includes[template]\n  }\n\n  var instance = this(template)\n\n  instance.update(state || {}, true)\n\n  if(el) {\n    instance.into(el)\n  }\n\n  return instance\n}\n","module.exports = insert\n\nfunction insert(parent, el, before) {\n  var inserted = el.parentNode !== parent\n\n  before = before || null\n\n  if(inserted || el.nextSibling !== before) {\n    parent.insertBefore(el, before)\n  }\n\n  if(inserted) {\n    this.emit('insert', el, parent)\n  }\n}\n","module.exports = remove\n\nfunction remove(parent, el) {\n  parent.removeChild(el)\n  this.emit('remove', el, parent)\n}\n","module.exports = requestAnimationFrame\n\nfunction requestAnimationFrame(callback) {\n  var raf = global.requestAnimationFrame ||\n    global.webkitRequestAnimationFrame ||\n    global.mozRequestAnimationFrame ||\n    timeout\n\n  return raf(callback)\n\n  function timeout(callback) {\n    return setTimeout(callback, 1000 / 60)\n  }\n}\n","var get = require('./get_element')\n\nmodule.exports = set_children\n\nfunction set_children(root, nodes) {\n  var prev = null\n    , el\n\n  for(var i = nodes.length - 1; i >= 0; --i) {\n    el = get(nodes[i])\n    this.insert(root, el, prev)\n    prev = el\n  }\n\n  while((el = root.firstChild) !== prev) {\n    this.remove(root, el)\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        throw TypeError('Uncaught, unspecified \"error\" event.');\n      }\n      return false;\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","var add_operators = require('./lib/operators')\n  , create_accesor = require('./lib/create')\n  , add_lookup = require('./lib/lookup')\n  , add_filter = require('./lib/filter')\n  , add_parens = require('./lib/parens')\n  , debounce = require('just-debounce')\n  , add_types = require('./lib/types')\n  , add_arrow = require('./lib/arrow')\n  , split = require('./lib/split')\n  , types = []\n\nmodule.exports = accessors\n\n// order is important\nadd_types(types)\nadd_arrow(types)\nadd_filter(types)\nadd_parens(types)\nadd_operators(types)\nadd_lookup(types)\n\naccessors.prototype.create_part = create_accesor\naccessors.prototype.add_filter = add_filter\naccessors.prototype.create = create\naccessors.prototype.types = types\naccessors.prototype.split = split\n\nfunction accessors(filters, delay) {\n  if(!(this instanceof accessors)) {\n    return new accessors(filters, delay)\n  }\n\n  if(!delay && delay !== false) {\n    delay = 0\n  }\n\n  this.delay = delay\n  this.filters = filters || {}\n}\n\nfunction add_filter(name, fn) {\n  this.filters[name] = fn\n}\n\nfunction create(str, change, all) {\n  var part = this.create_part(\n      str\n    , this.delay === false ? update : debounce(change, this.delay, false, true)\n  )\n\n  var sync = false\n    , prev = {}\n    , out\n\n  return write\n\n  function write(data) {\n    sync = true\n    out = null\n    part(data)\n    sync = false\n\n    if(out) {\n      change.apply(null, out)\n    }\n  }\n\n  function update(val, ctx) {\n    if(!all && typeof val !== 'object' && val === prev) {\n      return\n    }\n\n    out = [].slice.call(arguments)\n    prev = val\n\n    if(!sync) {\n      change.apply(null, out)\n    }\n  }\n}\n","module.exports = Batch\n\nfunction Batch(ready, all) {\n  if(!(this instanceof Batch)) {\n    return new Batch(ready, all)\n  }\n\n  this.jobs = []\n  this.all = all\n  this.ready = ready\n  this.queud = false\n  this.run = this.run.bind(this)\n}\n\nBatch.prototype.queue = queue\nBatch.prototype.add = add\nBatch.prototype.run = run\n\nfunction add(fn) {\n  var queued = false\n    , batch = this\n    , self\n    , args\n\n  return queue\n\n  function queue() {\n    args = [].slice.call(arguments)\n    self = this\n\n    if(queued) {\n      return batch.all && batch.ready()\n    }\n\n    queued = true\n    batch.queue(run)\n  }\n\n  function run() {\n    queued = false\n    fn.apply(self, args)\n  }\n}\n\nfunction queue(fn) {\n  this.jobs.push(fn)\n\n  if(this.all || !this.queued) {\n    this.queued = true\n    this.ready(this)\n  }\n}\n\nfunction run() {\n  var jobs = this.jobs\n\n  this.jobs = []\n  this.queued = false\n\n  for(var i = 0, l = jobs.length; i < l; ++i) {\n    jobs[i]()\n  }\n}\n","module.exports = add_lookup\n\nfunction add_lookup(types) {\n  types.push(create_lookup)\n}\n\nfunction create_lookup(path, change) {\n  if(!path.indexOf('$data')) {\n    path = path.slice('$data.'.length)\n\n    if(!path) {\n      return change\n    }\n  }\n\n  return lookup(path.match(/\\s*(.*[^\\s])\\s*/)[1], change)\n}\n\nfunction lookup(path, done) {\n  var parts = path ? path.split('.') : []\n\n  return function search(obj, ctx) {\n    for(var i = 0, l = parts.length; obj && i < l; ++i) {\n      obj = obj[parts[i]]\n    }\n\n    if(typeof obj === 'undefined' && ctx) {\n      return search(ctx)\n    }\n\n    if(i === l) {\n      return done(obj)\n    }\n\n    done()\n  }\n}\n","module.exports = accessor\n\nfunction accessor(key, change) {\n  var part = build_part.call(this, key, finish)\n    , context\n\n  return call.bind(this)\n\n  function call(val, ctx) {\n    part(val, context = ctx || val)\n  }\n\n  function finish(val) {\n    change.call(this, val, context)\n  }\n}\n\nfunction build_part(part, change) {\n  var accessor\n\n  for(var i = 0, l = this.types.length; i < l; ++i) {\n    if(accessor = this.types[i].call(this, part, change)) {\n      return accessor\n    }\n  }\n}\n","var ternary_regexp = /^\\s*(.+?)\\s*\\?(.*)\\s*$/\n\nmodule.exports = add_operators\n\nfunction add_operators(types) {\n  types.push(create_ternary)\n  types.push(binary(['|\\\\|']))\n  types.push(binary(['&&']))\n  types.push(binary(['|']))\n  types.push(binary(['^']))\n  types.push(binary(['&']))\n  types.push(binary(['===', '!==', '==', '!=']))\n  types.push(binary(['>=', '<=', '>', '<', ' in ', ' instanceof ']))\n  // types.push(binary(['<<', '>>', '>>>'])) //conflics with < and >\n  types.push(binary(['+', '-']))\n  types.push(binary(['*', '/', '%']))\n  types.push(unary(['!', '+', '-', '~']))\n}\n\nfunction binary(list) {\n  var regex = new RegExp(\n      '^\\\\s*(.+?)\\\\s\\*(\\\\' +\n      list.join('|\\\\') +\n      ')\\\\s*(.+?)\\\\s*$'\n  )\n\n  return function(parts, change) {\n    return create_binary.call(this, regex, parts, change)\n  }\n}\n\nfunction unary(list) {\n  var regex = new RegExp(\n      '^\\\\s*(\\\\' +\n      list.join('|\\\\') +\n      ')\\\\s*(.+?)\\\\s*$'\n  )\n\n  return function(parts, change) {\n    return create_unary.call(this, regex, parts, change)\n  }\n}\n\nfunction create_ternary(parts, change) {\n  if(!(parts = parts.match(ternary_regexp))) {\n    return\n  }\n\n  var condition = parts[1]\n    , rest = parts[2]\n    , count = 1\n\n  rest = this.split(rest, ':', ['?'], [':'])\n\n  if(rest.length !== 2) {\n    throw new Error('Unmatched ternary: ' + parts[0])\n  }\n\n  var not = this.create_part(rest[1], change)\n    , ok = this.create_part(rest[0], change)\n\n  return this.create_part(condition, update)\n\n  function update(val, context) {\n    return val ? ok(context) : not(context)\n  }\n}\n\nfunction create_binary(regex, parts, change) {\n  if(!(parts = parts.match(regex))) {\n    return\n  }\n\n  var check_lhs = this.create_part(parts[1], update.bind(null, false))\n    , check_rhs = this.create_part(parts[3], update.bind(null, true))\n    , lhs\n    , rhs\n\n  var changed = Function(\n      'change, lhs, rhs'\n    , 'return change(lhs ' + parts[2] + ' rhs)'\n  ).bind(null, change)\n\n  return on_data\n\n  function on_data(data, ctx) {\n    check_lhs(data, ctx)\n    check_rhs(data, ctx)\n  }\n\n  function update(is_rhs, val) {\n    is_rhs ? rhs = val : lhs = val\n    changed(lhs, rhs)\n  }\n}\n\nfunction create_unary(regex, parts, change) {\n  if(!(parts = parts.match(regex))) {\n    return\n  }\n\n  var changed = Function(\n      'change, val'\n    , 'return change(' + parts[1] + 'val)'\n  ).bind(null, change)\n\n  return this.create_part(parts[2], changed)\n}\n","var filter_regexp = /^\\s*([^\\s(]+)\\((.*)\\)\\s*$/\n\nmodule.exports = add_filter\n\nfunction add_filter(types) {\n  types.push(create_filter)\n}\n\nfunction create_filter(parts, change) {\n  if(!(parts = parts.match(filter_regexp))) {\n    return\n  }\n\n  var filter = this.filters[parts[1]]\n\n  if(!filter) {\n    throw new Error('could not find filter: ' + parts[1])\n  }\n\n  return filter.call(this, this.split(parts[2], ',', null, null, true), change)\n}\n","var parens_regexp = /^\\s*\\((.*)$/\n\nmodule.exports = add_parens\n\nfunction add_parens(types) {\n  types.push(create_parens)\n}\n\nfunction create_parens(parts, change) {\n  if(!(parts = parts.match(parens_regexp))) {\n    return\n  }\n\n  var body = parts[1]\n    , count = 1\n\n  for(var i = 0, l = body.length; i < l; ++i) {\n    if(body[i] === ')') {\n      --count\n    } else if(body[i] === '(') {\n      ++count\n    }\n\n    if(!count) {\n      break\n    }\n  }\n\n  if(!i || i === l) {\n    throw new Error('Unmatched ternary: ' + parts[0])\n  }\n\n  var content =  this.create_part(body.slice(0, i), update)\n    , key = 'paren_' + Math.random().toString(16).slice(2)\n\n  var template = this.create_part(key + body.slice(i + 1), change)\n\n  return content\n\n  function update(val, context) {\n    context = Object.create(context)\n    context[key] = val\n    template(context)\n  }\n}\n","var string_regexp = /^\\s*(?:'((?:[^'\\\\]|(?:\\\\.))*)'|\"((?:[^\"\\\\]|(?:\\\\.))*)\")\\s*$/\n  , number_regexp = /^\\s*(\\d*(?:\\.\\d+)?)\\s*$/\n\nmodule.exports = add_types\n\nfunction add_types(types) {\n  types.push(create_string_accessor)\n  types.push(create_number_accessor)\n}\n\nfunction create_string_accessor(parts, change) {\n  if(!(parts = parts.match(string_regexp))) {\n    return\n  }\n\n  return function() {\n    change(parts[1] || parts[2])\n  }\n}\n\nfunction create_number_accessor(parts, change) {\n  if(!(parts = parts.match(number_regexp))) {\n    return\n  }\n\n  return function() {\n    change(+parts[1])\n  }\n}\n","module.exports = add_arrow\n\nfunction add_arrow(types) {\n  types.push(create_arrow)\n}\n\nfunction create_arrow(parts, change) {\n  parts = this.split(parts, '->')\n\n  if(parts.length < 2) {\n    return\n  }\n\n  var right = this.create_part(parts[1], change)\n    , left = this.create_part(parts[0], update)\n\n  return left\n\n  function update(val, ctx) {\n    right(val, ctx)\n  }\n}\n","module.exports = split\n\nfunction split(parts, key, opens, closes, all) {\n  var all_closes = [')', '}', ']']\n    , all_opens = ['(', '{', '[']\n    , sum = 0\n    , split_point\n    , index\n\n  if(opens) {\n    all_opens = all_opens.concat(opens)\n  }\n\n  if(closes) {\n    all_closes = all_closes.concat(closes)\n  }\n\n  var counts = all_opens.map(function() {\n    return 0\n  })\n\n  for(var i = 0, l = parts.length; i < l; ++i) {\n    if(!sum && (split_point = parts.slice(i).indexOf(key)) === -1) {\n      return [parts]\n    }\n\n    if(!sum && !split_point) {\n      break\n    }\n\n    if((index = all_opens.indexOf(parts[i])) !== -1) {\n      ++counts[index]\n      ++sum\n    } else if((index = all_closes.indexOf(parts[i])) !== -1) {\n      --counts[index]\n      --sum\n    }\n\n    for(var j = 0; j < counts.length; ++j) {\n      if(counts[j] < 0) {\n        throw new Error('Unmatched \"' + all_opens[j] + '\"\" in ' + parts)\n      }\n    }\n  }\n\n  if(sum || i === parts.length) {\n    return [parts]\n  }\n\n  var right = parts.slice(i + key.length)\n    , left = parts.slice(0, i)\n\n  if(!all) {\n    return [left, right]\n  }\n\n  return [left].concat(split(right, key, opens, closes, all))\n}\n","module.exports = debounce\n\nfunction debounce(fn, delay, at_start, guarantee) {\n  var timeout\n    , args\n\n  return function() {\n    var self = this\n\n    args = Array.prototype.slice.call(arguments)\n\n    if(timeout && (at_start || guarantee)) {\n      return\n    } else if(!at_start) {\n      clear()\n\n      return timeout = setTimeout(run, delay)\n    }\n\n    timeout = setTimeout(clear, delay)\n    fn.apply(self, args)\n\n    function run() {\n      clear()\n      fn.apply(self, args)\n    }\n\n    function clear() {\n      clearTimeout(timeout)\n      timeout = null\n    }\n  }\n}\n"]}